{% extends "admin/base.html" %} {% block content %}
<div class="flex justify-center align-center w-full">
  <div
    class="relative overflow-x-auto flex justify-center align-center"
  >
    <table class=" text-sm text-left rtl:text-right text-gray-500 w-[80vw]" id="blogs_table">
      <thead class="text-xs text-gray-700 uppercase bg-gray-50">
        <tr>
          <th scope="col" class="px-6 py-3">S.no</th>
          <th scope="col" class="px-6 py-3">Title</th>
          <th scope="col" class="px-6 py-3">Author</th>
          <th scope="col" class="px-6 py-3">Short Description</th>
          <th scope="col" class="px-6 py-3">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for blog in blogs_data %}

        <tr class="bg-white border-b" key="{{blog[0]}}">
          <th
            scope="row"
            class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap"
          >
            {{ blog[0]}}
          </th>
          <td class="px-6 py-4">{{ blog[1]}}</td>
          <td class="px-6 py-4">{{ blog[5]}}</td>
          <td class="px-6 py-4">{{ blog[2] }}</td>
          <td class="px-6 py-4">
            <button 
              type="button"
              id = "edit-blog-btn"
              class="focus:outline-none text-white bg-yellow-400 hover:bg-yellow-500 focus:ring-4 focus:ring-yellow-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2"
            >
              Edit
            </button>

            <button
              type="button" 
              id = "{{blog[0]}}" 
              class="focus:outline-none text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 delete_blog" 
            >
              Delete
            </button>

            <!-- 2 Buttons -->
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
<!-- Modals --> 

<!-- Edit Modal --> 
<div
  id="edit-modal"
  tabindex="-1"
  aria-hidden="true"
  class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"
>
  <div class="relative p-4 w-full max-w-md max-h-full">
    <!-- Modal content -->
    <div class="relative bg-white rounded-lg shadow">
      <!-- Modal header -->
      <div
        class="flex items-center justify-between p-4 md:p-5 border-b rounded-t"
      >
        <h3 class="text-lg font-semibold text-gray-900">Create New Product</h3>
        <!-- <button
          type="button"
          class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center"
          data-modal-toggle="edit-modal"
        > -->
          <svg
            class="w-3 h-3"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 14 14"
          >
            <path
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"
            />
          </svg>
          <span class="sr-only">Close modal</span>
        </button>
      </div>
      <!-- Modal body -->
      <form class="p-4 md:p-5">
        <div class="grid gap-4 mb-4 grid-cols-2">
          <div class="col-span-2">
            <label
              for="name"
              class="block mb-2 text-sm font-medium text-gray-900"
              >Name</label
            >
            <input
              type="text"
              name="name"
              id="name"
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5"
              placeholder="Type product name"
              required=""
            />
          </div>
          <div class="col-span-2 sm:col-span-1">
            <label
              for="price"
              class="block mb-2 text-sm font-medium text-gray-900"
              >Price</label
            >
            <input
              type="number"
              name="price"
              id="price"
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5"
              placeholder="$2999"
              required=""
            />
          </div>
          <div class="col-span-2 sm:col-span-1">
            <label
              for="category"
              class="block mb-2 text-sm font-medium text-gray-900 "
              >Category</label
            >
            <select
              id="category"
              class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5  "
            >
              <option selected="">Select category</option>
              <option value="TV">TV/Monitors</option>
              <option value="PC">PC</option>
              <option value="GA">Gaming/Console</option>
              <option value="PH">Phones</option>
            </select>
          </div>
          <div class="col-span-2">
            <label
              for="description"
              class="block mb-2 text-sm font-medium text-gray-900  "
              >Product Description</label
            >
            <textarea
              id="description"
              rows="4"
              class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500  "
              placeholder="Write product description here"
            ></textarea>
          </div>
        </div>
        <button
          type="submit"
          class="text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center "
        >
          <svg
            class="me-1 -ms-1 w-5 h-5"
            fill="currentColor"
            viewBox="0 0 20 20"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z"
              clip-rule="evenodd"
            ></path>
          </svg>
          Add new product
        </button>
      </form>
    </div>
  </div>
</div> 
<!-- End of Edit Modal -->

<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
<script src="//cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
<script>
    $(document).ready(() => {
        $("#blogs_table").DataTable();
    });
</script>

<script>
        // Delete Btn click event
        deletes = document.getElementsByClassName("delete_blog");
        Array.from(deletes).forEach((element) => {
            element.addEventListener("click", (e) => { 
                sno = e.target.id;
                
                sno = sno.trim();
                console.log(sno);
                if (confirm("Are you sure you want to delete this submission!")) { 
                    fetch(`/api/admin/delete_blog?blog_id=${sno}`, {
                        method: "GET",
                    }).then((response) => { return response.json(); }).then((data) => { 
                        console.log(data);
                        if (data.success) { 
                            alert("Blog has been deleted successfully");
                            window.location.reload();
                        } else { 
                          
                            alert("Some error occured");
                            alert(data.message);
                        }
                    });
                } else { 
                }
            });
        });

        // Edit btn click event
        // edits = document.getElementsByClassName("edit");
        // Array.from(edits).forEach((element) => {
        //     element.addEventListener("click", (e) => {
        //         // console.log("edit",e.target);
        //         tr = e.target.parentNode.parentNode;
        //         console.log(tr)
        //         sno = e.target.id.substr(1);
        //         sno = sno.trim();
        //         console.log(sno)

        //         id = tr.getElementsByTagName("td")[0].innerText;
        //         type = tr.getElementsByTagName("td")[1].innerText
        //         heading = tr.getElementsByTagName("td")[2].innerText;
        //         content = tr.getElementsByTagName("td")[3].innerText;
        //         imageLink = tr.getElementsByTagName("td")[4].innerText;
        //         views = tr.getElementsByTagName("td")[5].innerText;
        //         magazine_link = tr.getElementsByTagName("td")[6].innerText;
        //         admin = tr.getElementsByTagName("td")[7].innerText;

        //         snoEdit.value = `${sno}`
        //         idEdit.value = `${id}`
        //         typeEdit.value = `${type}`
        //         headingEdit.value = `${heading}`
        //         contentEdit.value = `${content}`
        //         imageLinkEdit.value = `${imageLink}`
        //         viewsEdit.value = `${views}`
        //         magazinePdfLinkEdit.value = `${magazine_link}`
        //         adminEdit.value = `${admin}`

        //         $("#editModal").modal("toggle");
        //     });
        // });
    </script>

{% endblock %}
